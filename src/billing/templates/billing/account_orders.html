{% extends 'base/index.html' %}

{% block main_content %}


{% if not request.user.is_authenticated %}
    {% include 'base/welcome.html' %}
{% else %}

    <div class="alert alert-secondary text-center" role="alert">

        <form method="post">
        {% csrf_token %}
            <div class="row">
                <div class="row col-6">
                    <div class="col-3">
                        <fieldset>
                            {% bootstrap_field form.year layout="horizontal" placeholder="" size="small" label_class="form-label col-sm-4 text-right" horizontal_field_class="col-sm-8" %}
                        </fieldset>
                    </div>
                    <div class="col-3">
                        <fieldset>
                            {% bootstrap_field form.month layout="horizontal" placeholder="" size="small" label_class="form-label col-sm-4 text-right" horizontal_field_class="col-sm-8" %}
                        </fieldset>
                    </div>
                    <div class="col-1">
                        <button class="form-button btn-sm btn-success">Show</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <h3>You are seeing {{ period }} orders history</h3>

    <table class="table table-hover">
        <tr>
            <th>Description</th>
            <th>Date</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>

        {% for order in objects %}

            <tr>
                <td><a href="{{ order.id }}">{{ order.description }}</a></td>
                <td>{{ order.started_at }}</td>
                <td>{{ order.status }}</td>
                <td>
                    {% if order.is_processable %}
                        <a class="btn btn-success" role="button" href="{% url 'billing_order_process' order.id %}">Confirm</a>
                        <a class="btn btn-warning" role="button" href="{% url 'billing_order_cancel' order.id %}">Cancel</a>
                    {% elif order.is_processed %}
                        <a  class="btn btn-info" role="button" href="{% url 'billing_invoice' %}?order_id={{ order.id }}">Download Invoice</a>
                    {% endif %}
                </td>
            </tr>

        {% endfor %}

    </table>

    {% if is_order_filtered == True %}
        <a class="btn btn-info" role="button" href="{% url 'billing_invoice' %}?order_id={{ order_id_list }}&period={{ period }}">Download Invoice for This Period</a>
        <a class="btn btn-success" role="button" href="{% url 'billing_orders' %}">Back to All Orders History</a>
    {% endif %}

{% include 'base/pagination.html' %}

{% endif %}


{% endblock %}
